{
  "active": false,
  "activeVersion": null,
  "activeVersionId": null,
  "connections": {
    "When clicking ‘Execute workflow’": {
      "main": [
        [
          {
            "node": "Get row(s)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s)": {
      "main": [
        [
          {
            "node": "Filter-AU",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Filter-AU": {
      "main": [
        [
          {
            "node": "Temp Filter",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Temp Filter": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [],
        [
          {
            "node": "Get row(s)1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s)1": {
      "main": [
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items1": {
      "main": [
        [
          {
            "node": "Search a file",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append rows to table": {
      "main": [
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait": {
      "main": [
        [
          {
            "node": "Append rows to table",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search a file": {
      "main": [
        [
          {
            "node": "Download a file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Download a file": {
      "main": [
        [
          {
            "node": "Upload file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2026-01-22T04:13:46.233Z",
  "id": "cFC4Cn8yykvkbmXZ",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "Zenoti - Guest Data to Excel",
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -512,
        -80
      ],
      "id": "b158a0d5-a542-4125-a7b6-dbac0cfac970",
      "name": "When clicking ‘Execute workflow’"
    },
    {
      "parameters": {
        "operation": "get",
        "dataTableId": {
          "__rl": true,
          "value": "lsINP70DmcZtIj4M",
          "mode": "list",
          "cachedResultName": "ZenotiClinics",
          "cachedResultUrl": "/projects/gMwV5v9nxJB6matq/datatables/lsINP70DmcZtIj4M"
        },
        "returnAll": true
      },
      "type": "n8n-nodes-base.dataTable",
      "typeVersion": 1.1,
      "position": [
        -304,
        -80
      ],
      "id": "79823d55-2450-4034-8159-68bd93214e0d",
      "name": "Get row(s)"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "6670f9b3-a693-485c-aa59-b880393a7b47",
              "leftValue": "={{ $json.Country_Code }}",
              "rightValue": "AU",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.filter",
      "typeVersion": 2.3,
      "position": [
        -96,
        -80
      ],
      "id": "cb36bf83-60de-44d4-8d7a-e5a1bfbe1dd5",
      "name": "Filter-AU"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "ad267cac-9f94-4b27-9974-7132788b52f9",
              "leftValue": "={{ $json.code }}",
              "rightValue": "CW",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.filter",
      "typeVersion": 2.3,
      "position": [
        112,
        -80
      ],
      "id": "d506a1f3-154e-40f1-912d-e55fc66c3afb",
      "name": "Temp Filter"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -512,
        176
      ],
      "id": "7e419a3e-c44a-4190-a08d-f96639c88021",
      "name": "Loop Over Items"
    },
    {
      "parameters": {
        "operation": "get",
        "dataTableId": {
          "__rl": true,
          "value": "={{ $('Temp Filter').item.json.table_id }}",
          "mode": "id"
        },
        "returnAll": true
      },
      "type": "n8n-nodes-base.dataTable",
      "typeVersion": 1.1,
      "position": [
        -320,
        256
      ],
      "id": "c150c6bb-994a-408f-bbeb-7da1920c30ab",
      "name": "Get row(s)1"
    },
    {
      "parameters": {
        "resource": "table",
        "workbook": {
          "__rl": true,
          "value": "012CMKCCEIUS5SMQO3TJHLPAEWDF2Y2LYB",
          "mode": "list",
          "cachedResultName": "Zenoti-GuestFormData",
          "cachedResultUrl": "https://ashleyandmartincomau-my.sharepoint.com/personal/nryall_ashleyandmartin_com_au/_layouts/15/Doc.aspx?sourcedoc=%7B26BBA488-DB41-4E9A-B780-9619758D2F01%7D&file=Zenoti-GuestFormData.xlsx&action=default&mobileredirect=true&DefaultItemOpen=1"
        },
        "worksheet": {
          "__rl": true,
          "value": "{00000000-0001-0000-0000-000000000000}",
          "mode": "list",
          "cachedResultName": "Sheet1",
          "cachedResultUrl": "https://ashleyandmartincomau-my.sharepoint.com/personal/nryall_ashleyandmartin_com_au/_layouts/15/Doc.aspx?sourcedoc=%7B26BBA488-DB41-4E9A-B780-9619758D2F01%7D&file=Zenoti-GuestFormData.xlsx&action=default&mobileredirect=true&DefaultItemOpen=1&activeCell=Sheet1!A1"
        },
        "table": {
          "__rl": true,
          "value": "{574F5FEF-D38D-4DD1-97B6-E3BD9F13CC9A}",
          "mode": "list",
          "cachedResultName": "GuestFormData",
          "cachedResultUrl": "https://ashleyandmartincomau-my.sharepoint.com/personal/nryall_ashleyandmartin_com_au/_layouts/15/Doc.aspx?sourcedoc=%7B26BBA488-DB41-4E9A-B780-9619758D2F01%7D&file=Zenoti-GuestFormData.xlsx&action=default&mobileredirect=true&DefaultItemOpen=1&activeCell=Sheet1!A1:AN2"
        },
        "dataMode": "autoMap",
        "options": {}
      },
      "type": "n8n-nodes-base.microsoftExcel",
      "typeVersion": 2.2,
      "position": [
        400,
        400
      ],
      "id": "776928e3-fe15-40a2-acff-9b2409b09c27",
      "name": "Append rows to table",
      "executeOnce": false,
      "retryOnFail": true,
      "waitBetweenTries": 5000,
      "credentials": {
        "microsoftExcelOAuth2Api": {
          "id": "snb39Kzd4tl5cSJU",
          "name": "Microsoft Excel account"
        }
      }
    },
    {
      "parameters": {
        "batchSize": 20,
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -64,
        256
      ],
      "id": "7fdb2298-6c4b-4d0a-90b7-2d132559b102",
      "name": "Loop Over Items1"
    },
    {
      "parameters": {
        "amount": 1
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        176,
        352
      ],
      "id": "5602598e-0db8-48b4-b67b-0fc82972575a",
      "name": "Wait",
      "webhookId": "8595834c-7ca4-4ddf-8859-4685f9e3d1e3"
    },
    {
      "parameters": {
        "content": "## Grab Tables of Clinics",
        "height": 288,
        "width": 432
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -560,
        -192
      ],
      "typeVersion": 1,
      "id": "79ad3235-6b3d-43a9-87e1-4925e838519b",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "## Filter Down to Required Clinic",
        "height": 288,
        "width": 416,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -128,
        -192
      ],
      "typeVersion": 1,
      "id": "fef35b71-e2b7-4478-b2d0-96c993ce0628",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "content": "## Loop Over Clinc To Grab Client Details",
        "height": 304,
        "width": 432,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -560,
        96
      ],
      "typeVersion": 1,
      "id": "66233116-d193-47bd-b35e-a1e79789dead",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "content": "## Batch loop of uploading Clients to Excel",
        "height": 496,
        "width": 704,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -128,
        96
      ],
      "typeVersion": 1,
      "id": "fcb8a4f1-5535-4960-b05a-4f23d2e6bf4c",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "content": "## Replace Excel File in IT common",
        "height": 288,
        "width": 784
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        288,
        -192
      ],
      "typeVersion": 1,
      "id": "552de5a5-8b0a-45aa-8e29-17f08d255c7f",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "operation": "search",
        "query": "Zenoti-GuestFormData.xlsx"
      },
      "type": "n8n-nodes-base.microsoftOneDrive",
      "typeVersion": 1,
      "position": [
        400,
        -80
      ],
      "id": "5947b162-f4f3-4324-a0e0-38c5c01639b3",
      "name": "Search a file",
      "executeOnce": true,
      "credentials": {
        "microsoftOneDriveOAuth2Api": {
          "id": "YQJEXWiBLg1Zt1YR",
          "name": "Microsoft Drive account"
        }
      }
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": "={{ $json.id }}"
      },
      "type": "n8n-nodes-base.microsoftOneDrive",
      "typeVersion": 1,
      "position": [
        608,
        -80
      ],
      "id": "bb0ee832-3e32-49aa-821a-c6a3531f730f",
      "name": "Download a file",
      "credentials": {
        "microsoftOneDriveOAuth2Api": {
          "id": "YQJEXWiBLg1Zt1YR",
          "name": "Microsoft Drive account"
        }
      }
    },
    {
      "parameters": {
        "operation": "upload",
        "site": {
          "__rl": true,
          "value": "ashleyandmartincomau.sharepoint.com,b36f54fe-6363-4f80-a917-80ea79163f8f,e253e1e6-f0a2-48df-99ae-a6211683cee6",
          "mode": "list",
          "cachedResultName": "HeadOffice"
        },
        "folder": {
          "__rl": true,
          "value": "01B6E6QFLOHI7RD75M3ZAZGOK2L55CWEYX",
          "mode": "list",
          "cachedResultName": "Zenoti Data"
        },
        "fileName": "=Zenoti-GuestFormData-{{ $today.toISODate() }}.xlsx",
        "fileContents": "data",
        "requestOptions": {}
      },
      "type": "n8n-nodes-base.microsoftSharePoint",
      "typeVersion": 1,
      "position": [
        816,
        -80
      ],
      "id": "4a085139-5898-4772-90c3-ae1f73364904",
      "name": "Upload file",
      "credentials": {
        "microsoftSharePointOAuth2Api": {
          "id": "8eWNjQciijocacKo",
          "name": "Microsoft SharePoint account"
        }
      }
    }
  ],
  "origin": "n8n",
  "pinData": {},
  "repo": {
    "owner": "AMNicholasRyall",
    "name": "n8n-workflow-Backup"
  },
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "shared": [
    {
      "updatedAt": "2026-01-22T04:13:46.236Z",
      "createdAt": "2026-01-22T04:13:46.236Z",
      "role": "workflow:owner",
      "workflowId": "cFC4Cn8yykvkbmXZ",
      "projectId": "gMwV5v9nxJB6matq"
    }
  ],
  "staticData": null,
  "tags": [
    {
      "updatedAt": "2025-11-07T01:33:39.006Z",
      "createdAt": "2025-11-07T01:33:39.006Z",
      "id": "WIsNIXL4vR1ZWj36",
      "name": "Zenoti"
    },
    {
      "updatedAt": "2026-01-21T23:52:24.742Z",
      "createdAt": "2026-01-21T23:52:24.742Z",
      "id": "gBgZjsV5vc1ZGBw4",
      "name": "AUS"
    }
  ],
  "triggerCount": 0,
  "updatedAt": "2026-01-27T23:52:44.643Z",
  "versionId": "9772d0c7-3ea0-4725-b145-f3bb2037a8fd"
}